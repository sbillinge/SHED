

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>shed package &mdash; SHED  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="shed.tests package" href="shed.tests.html" />
    <link rel="prev" title="Welcome to SHED’s documentation!" href="index.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SHED
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">shed package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="shed.tests.html">shed.tests package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-shed.event_streams">shed.event_streams module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-shed.unused_streams">shed.unused_streams module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-shed">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SHED</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>shed package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/shed.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="shed-package">
<h1>shed package<a class="headerlink" href="#shed-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="shed.tests.html">shed.tests package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="shed.tests.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="shed.tests.html#module-shed.tests.conftest">shed.tests.conftest module</a></li>
<li class="toctree-l2"><a class="reference internal" href="shed.tests.html#shed-tests-test-against-runengine-module">shed.tests.test_against_runengine module</a></li>
<li class="toctree-l2"><a class="reference internal" href="shed.tests.html#shed-tests-test-streams-module">shed.tests.test_streams module</a></li>
<li class="toctree-l2"><a class="reference internal" href="shed.tests.html#module-shed.tests.utils">shed.tests.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="shed.tests.html#module-shed.tests">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-shed.event_streams">
<span id="shed-event-streams-module"></span><h2>shed.event_streams module<a class="headerlink" href="#module-shed.event_streams" title="Permalink to this headline">¶</a></h2>
<p>Stream functions (actually classes) for building pipelines for the Event
Model</p>
<dl class="class">
<dt id="shed.event_streams.Bundle">
<em class="property">class </em><code class="descclassname">shed.event_streams.</code><code class="descname">Bundle</code><span class="sig-paren">(</span><em>*upstreams</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#Bundle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.Bundle" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shed.event_streams.EventStream" title="shed.event_streams.EventStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">shed.event_streams.EventStream</span></code></a></p>
<p>Combine multiple event streams into one</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>upstreams</strong> (<em>EventStream instances</em>) – The event streams to be zipped together</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">shed.utils</span> <span class="k">import</span> <span class="n">to_event_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">streamz_ext</span> <span class="k">import</span> <span class="n">Stream</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">shed.event_streams</span> <span class="k">as</span> <span class="nn">es</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">builtins</span> <span class="k">import</span> <span class="nb">zip</span> <span class="k">as</span> <span class="n">zzip</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># base data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">to_event_model</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gg</span> <span class="o">=</span> <span class="n">to_event_model</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source2</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">Bundle</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">source2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink</span><span class="p">(</span><span class="nb">print</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink_to_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">doc1</span><span class="p">,</span> <span class="n">doc2</span> <span class="ow">in</span> <span class="n">zzip</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">gg</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">z</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">doc1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">zz</span> <span class="o">=</span> <span class="n">source2</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">doc2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span>
</pre></div>
</div>
<dl class="method">
<dt id="shed.event_streams.Bundle.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>x</em>, <em>who=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#Bundle.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.Bundle.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Emit the new name document pair</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>tuple</em>) – Name document pair</li>
<li><strong>who</strong> (<em>stream instance, optional</em>) – This is mostly used internally for emit</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The list of issued documents, used for back pressure</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="shed.event_streams.BundleSingleStream">
<em class="property">class </em><code class="descclassname">shed.event_streams.</code><code class="descname">BundleSingleStream</code><span class="sig-paren">(</span><em>upstream</em>, <em>control_stream</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#BundleSingleStream"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.BundleSingleStream" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shed.event_streams.EventStream" title="shed.event_streams.EventStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">shed.event_streams.EventStream</span></code></a></p>
<p>Combine multiple headers in a single stream into one</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>upstream</strong> (<em>EventStream instances</em>) – The event stream containing the data to be zipped together</li>
<li><strong>control_stream</strong> (<em>{EventStream, int}</em>) – Information to control the buffering. If int, bundle that many
header together. If an EventStream, pull from the start document
<code class="docutils literal notranslate"><span class="pre">n_hdrs</span></code> to determine the number of headers to bundle</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">shed.utils</span> <span class="k">import</span> <span class="n">to_event_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">streamz_ext</span> <span class="k">import</span> <span class="n">Stream</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">shed.event_streams</span> <span class="k">as</span> <span class="nn">es</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># base data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">to_event_model</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gg</span> <span class="o">=</span> <span class="n">to_event_model</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">BundleSingleStream</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink</span><span class="p">(</span><span class="nb">print</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink_to_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">doc1</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span> <span class="n">zz</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">doc1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">doc2</span> <span class="ow">in</span> <span class="n">gg</span><span class="p">:</span> <span class="n">z</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">doc2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span>
</pre></div>
</div>
<dl class="method">
<dt id="shed.event_streams.BundleSingleStream.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>x</em>, <em>who=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#BundleSingleStream.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.BundleSingleStream.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Emit the new name document pair</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>tuple</em>) – Name document pair</li>
<li><strong>who</strong> (<em>stream instance, optional</em>) – This is mostly used internally for emit</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The list of issued documents, used for back pressure</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="shed.event_streams.EventStream">
<em class="property">class </em><code class="descclassname">shed.event_streams.</code><code class="descname">EventStream</code><span class="sig-paren">(</span><em>upstream=None</em>, <em>upstreams=None</em>, <em>*</em>, <em>output_info=None</em>, <em>input_info=None</em>, <em>md=None</em>, <em>stream_name=None</em>, <em>raise_upon_error=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#EventStream"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.EventStream" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">streamz_ext.core.Stream</span></code></p>
<p>The EventStream class handles data of the form of an infinite
sequence of events in the Event Model.</p>
<p>In the Event model, the data-stream is a series of fortunate events.
Each event consists of a name-document pair
where the dictionary contains the data and metadata associated with the
event.
More information here:
<a class="reference external" href="https://nsls-ii.github.io/architecture-overview.html">https://nsls-ii.github.io/architecture-overview.html</a></p>
<p>EventStreams subscribe to each other passing and transforming data between
them. An EventStream object listens for updates from upstream, reacts to
these updates, and then emits more data to flow downstream to all
EventStream objects that subscribe to it. Downstream EventStream objects
may connect at any point of an EventStream graph to get a full view of the
data coming off of that point to do with as they will.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><ul class="first last simple">
<li><strong>md</strong> (<em>dict</em>) – Each event stream has a Start document that contains metadata about
the stream</li>
<li><strong>input_info</strong> (<em>dict</em><em>, </em><em>optional</em>) – Input info for an operation. Operations are callables that will apply
operations to the data streams. Not always needed. The input_info
provides a map between event data keys and the callable (function)
args/kwargs.
Note that the keys for <cite>input_info</cite> can either be strings or integers.
If a string, then the data associated with the value will be mapped to
that kwarg in the funciton. If an int then the data will be placed in
the position in the args matching the numerical value.</li>
<li><strong>output_info</strong> (<em>list of tuples</em><em>, </em><em>optional</em>) – <p>Output info from the operation, not needed for all cases
This:</p>
<blockquote>
<div>Creates a map between function returns and event data keys
Provides information for building a descriptor for the output
event stream. Each event stream has a descriptor which contains
information about what is in the events in the stream.</div></blockquote>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This is intended as a base class for the stream functions (map, filter,
etc.).</p>
<p>Most implementations of the subclasses will:
a) override update for flow control based classes
b) override event for operator based classes
c) override multiple document methods (see eventify) although this is rare</p>
<p>It is important for the overridden document methods that the return
follows the pattern of <code class="docutils literal notranslate"><span class="pre">super().document_name(new_document)</span></code>. This way
the EventStream properly issues the new document with its name and other
needed internal flow control.</p>
<p>Nodes clean themselves when the receive a start document (with a few
exceptions, see BundleSingleStream).</p>
<dl class="method">
<dt id="shed.event_streams.EventStream.curate_streams">
<code class="descname">curate_streams</code><span class="sig-paren">(</span><em>nds</em>, <em>outbound</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#EventStream.curate_streams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.EventStream.curate_streams" title="Permalink to this definition">¶</a></dt>
<dd><p>Standardize inbound/outbound name document pairs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nds</strong> (<em>tuple, or tuple of tuples</em>) – The name document pair(s)</li>
<li><strong>outbound</strong> (<em>bool</em>) – If True curate streams outbound</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>name</strong> (<em>str</em>) – The name of the output doc(s)</li>
<li><strong>docs</strong> (<em>tuple or dict</em>) – The document(s)</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If we get multiple streams make (name, (doc, doc, doc, …))
Otherwise (name, (doc,))</p>
</dd></dl>

<dl class="method">
<dt id="shed.event_streams.EventStream.descriptor">
<code class="descname">descriptor</code><span class="sig-paren">(</span><em>docs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#EventStream.descriptor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.EventStream.descriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Issue new descriptor document for input documents</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>docs</strong> (<em>tuple of dicts or dict</em>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>name</strong> (<em>‘descriptor’</em>)</li>
<li><strong>doc</strong> (<em>dict</em>) – The document</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="shed.event_streams.EventStream.dispatch">
<code class="descname">dispatch</code><span class="sig-paren">(</span><em>nds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#EventStream.dispatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.EventStream.dispatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Dispatch to methods expecting particular doc types.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nds</strong> (<em>tuple</em>) – Name document pair</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">New name document pair</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="shed.event_streams.EventStream.doc_contents">
<code class="descname">doc_contents</code><span class="sig-paren">(</span><em>docs</em>, <em>full_event=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#EventStream.doc_contents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.EventStream.doc_contents" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide some of the event data as a dict, which may be used as kwargs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>docs</strong> (<em>tuple of dicts</em>)</li>
<li><strong>full_event</strong> (<em>bool, optional</em>) – If True expose the data from full event, else only expose data
from the ‘data’ dictionary inside the event, defaults to False</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>args</strong> (<em>tuple</em>) – The arguments to be passed to a function</li>
<li><strong>kwargs</strong> (<em>dict</em>) – The keyword arguments to be passed to a function</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="shed.event_streams.EventStream.emit">
<code class="descname">emit</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#EventStream.emit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.EventStream.emit" title="Permalink to this definition">¶</a></dt>
<dd><p>Push data into the stream at this point</p>
<p>Events will not automatically propagate down a stream unless they are
emitted, so for example, one could take every second event returned
from a node function and emit it into a subsampled output stream.
(for this specific example see <code class="docutils literal notranslate"><span class="pre">filter</span></code>)</p>
</dd></dl>

<dl class="method">
<dt id="shed.event_streams.EventStream.event">
<code class="descname">event</code><span class="sig-paren">(</span><em>docs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#EventStream.event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.EventStream.event" title="Permalink to this definition">¶</a></dt>
<dd><p>Issue event document for input documents</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>docs</strong> (<em>tuple of dicts or dict</em>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>name</strong> (<em>‘event’</em>)</li>
<li><strong>doc</strong> (<em>dict</em>) – The document</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="shed.event_streams.EventStream.generate_provenance">
<code class="descname">generate_provenance</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#EventStream.generate_provenance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.EventStream.generate_provenance" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate provenance information about the stream function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>func</strong> (<em>callable</em>) – The function used inside the stream class (see map, filter, etc.)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="shed.event_streams.EventStream.issue_event">
<code class="descname">issue_event</code><span class="sig-paren">(</span><em>outputs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#EventStream.issue_event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.EventStream.issue_event" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new event document based off of function returns</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>outputs</strong> (<em>tuple, dict, or other</em>) – Data returned from some external functon</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>new_event</strong> – The new event</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If the outputs of the function is an exception no event will be
created, but a stop document will be issued.</p>
</dd></dl>

<dl class="attribute">
<dt id="shed.event_streams.EventStream.pop_kwargs">
<code class="descname">pop_kwargs</code><em class="property"> = ['output_info', 'input_info', 'md', 'stream_name', 'raise_upon_error']</em><a class="headerlink" href="#shed.event_streams.EventStream.pop_kwargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="shed.event_streams.EventStream.refresh_event">
<code class="descname">refresh_event</code><span class="sig-paren">(</span><em>event</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#EventStream.refresh_event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.EventStream.refresh_event" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new event with the same data, but new metadata
(uid, timestamp, etc.)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>event</strong> (<em>tuple, dict, or other</em>) – The event document</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>new_event</strong> – A new event with the same core data</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="shed.event_streams.EventStream.start">
<code class="descname">start</code><span class="sig-paren">(</span><em>docs</em>, <em>clear=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#EventStream.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.EventStream.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Issue new start document for input documents</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>docs</strong> (<em>tuple of dicts or dict</em>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>name</strong> (<em>‘start’</em>)</li>
<li><strong>doc</strong> (<em>dict</em>) – The document</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="shed.event_streams.EventStream.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><em>docs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#EventStream.stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.EventStream.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Issue new stop document</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>docs</strong> (<em>tuple of dicts or dict or Exception</em>) – If Exception issue a stop which notes the failure</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>name</strong> (<em>‘stop’</em>)</li>
<li><strong>doc</strong> (<em>dict</em>) – The document</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="shed.event_streams.EventStream.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>x</em>, <em>who=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#EventStream.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.EventStream.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Emit the new name document pair</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>tuple</em>) – Name document pair</li>
<li><strong>who</strong> (<em>stream instance, optional</em>) – This is mostly used internally for emit</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The list of issued documents, used for back pressure</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="shed.event_streams.Eventify">
<em class="property">class </em><code class="descclassname">shed.event_streams.</code><code class="descname">Eventify</code><span class="sig-paren">(</span><em>upstream</em>, <em>*keys</em>, <em>output_info=None</em>, <em>document='start'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#Eventify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.Eventify" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shed.event_streams.EventStream" title="shed.event_streams.EventStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">shed.event_streams.EventStream</span></code></a></p>
<p>Generate events from data in starts</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>upstream</strong> (<em>EventStream instance</em>) – The event stream to eventify</li>
<li><strong>start_keys</strong> (<em>str, optional</em>) – The run start keys to use to create the events
If none supplied, then load all start keys into event</li>
<li><strong>output_info</strong> (<em>list of tuples, optional</em>) – describes the resulting stream</li>
<li><strong>document</strong> (<em>{‘start’, ‘descriptor’, ‘stop}, optional</em>) – The document to generate events from. Defaults to ‘start’</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">shed.utils</span> <span class="k">import</span> <span class="n">to_event_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">streamz_ext</span> <span class="k">import</span> <span class="n">Stream</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">shed.event_streams</span> <span class="k">as</span> <span class="nn">es</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># base data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">to_event_model</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">Eventify</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">output_info</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;start_uid&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink</span><span class="p">(</span><span class="nb">print</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink_to_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">doc1</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">zz</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">doc1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span>
</pre></div>
</div>
<dl class="method">
<dt id="shed.event_streams.Eventify.event">
<code class="descname">event</code><span class="sig-paren">(</span><em>docs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#Eventify.event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.Eventify.event" title="Permalink to this definition">¶</a></dt>
<dd><p>Issue event document for input documents</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>docs</strong> (<em>tuple of dicts or dict</em>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>name</strong> (<em>‘event’</em>)</li>
<li><strong>doc</strong> (<em>dict</em>) – The document</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="shed.event_streams.Eventify.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>x</em>, <em>who=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#Eventify.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.Eventify.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Emit the new name document pair</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>tuple</em>) – Name document pair</li>
<li><strong>who</strong> (<em>stream instance, optional</em>) – This is mostly used internally for emit</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The list of issued documents, used for back pressure</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="shed.event_streams.Query">
<em class="property">class </em><code class="descclassname">shed.event_streams.</code><code class="descname">Query</code><span class="sig-paren">(</span><em>db</em>, <em>upstream</em>, <em>query_function</em>, <em>query_decider=None</em>, <em>max_n_hdrs=10</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#Query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.Query" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shed.event_streams.EventStream" title="shed.event_streams.EventStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">shed.event_streams.EventStream</span></code></a></p>
<p>Query a databroker for data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>db</strong> (<em>databroker.Broker instance</em>) – The databroker to be queried</li>
<li><strong>upstream</strong> (<em>EventStream instance</em>) – The stream to be subscribed to</li>
<li><strong>query_function</strong> (<em>callable</em>) – A function which executes a query against the databroker using the
start document of the stream. Note that the signature must be
<code class="docutils literal notranslate"><span class="pre">func(Broker,</span> <span class="pre">docs)</span></code> where docs is a tuple of documents and returns
the valid headers.</li>
<li><strong>query_decider</strong> (<em>callable, optional</em>) – A function to decide among the query results. The signature must be
func(list of headers, docs) and returns a single header. If not
provided use all the headers returned. Defaults to None. Note that the
query_decider must return an iterable.</li>
<li><strong>max_n_hdrs</strong> (<em>int, optional</em>) – Maximum number of headers returned, if the number of headers returned
is greater than the max then the node raises a RuntimeError</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="shed.event_streams.Query.start">
<code class="descname">start</code><span class="sig-paren">(</span><em>docs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#Query.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.Query.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Issue new start document for input documents</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>docs</strong> (<em>tuple of dicts or dict</em>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>name</strong> (<em>‘start’</em>)</li>
<li><strong>doc</strong> (<em>dict</em>) – The document</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="shed.event_streams.Query.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>x</em>, <em>who=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#Query.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.Query.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Emit the new name document pair</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>tuple</em>) – Name document pair</li>
<li><strong>who</strong> (<em>stream instance, optional</em>) – This is mostly used internally for emit</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The list of issued documents, used for back pressure</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="shed.event_streams.QueryUnpacker">
<em class="property">class </em><code class="descclassname">shed.event_streams.</code><code class="descname">QueryUnpacker</code><span class="sig-paren">(</span><em>db</em>, <em>upstream</em>, <em>fill=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#QueryUnpacker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.QueryUnpacker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shed.event_streams.EventStream" title="shed.event_streams.EventStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">shed.event_streams.EventStream</span></code></a></p>
<p>Unpack Queries from the Query node</p>
<p>This unpacks the start uids passed down from the Query node and creates
a restream of the data for each header</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>db</strong> (<em>databroker.Broker instance</em>) – The databroker to be queried</li>
<li><strong>upstream</strong> (<em>EventStream instance</em>) – The stream to be subscribed to</li>
<li><strong>fill</strong> (<em>bool, optional</em>) – Whether or not to fill the documents, defaults to True</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="shed.event_streams.QueryUnpacker.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>x</em>, <em>who=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#QueryUnpacker.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.QueryUnpacker.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Emit the new name document pair</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>tuple</em>) – Name document pair</li>
<li><strong>who</strong> (<em>stream instance, optional</em>) – This is mostly used internally for emit</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The list of issued documents, used for back pressure</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="shed.event_streams.accumulate">
<em class="property">class </em><code class="descclassname">shed.event_streams.</code><code class="descname">accumulate</code><span class="sig-paren">(</span><em>func</em>, <em>upstream</em>, <em>state_key=None</em>, <em>full_event=False</em>, <em>output_info=None</em>, <em>input_info=None</em>, <em>start='--no-default--'</em>, <em>across_start=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#accumulate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.accumulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shed.event_streams.EventStream" title="shed.event_streams.EventStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">shed.event_streams.EventStream</span></code></a></p>
<p>Accumulate results with previous state</p>
<p>This preforms running or cumulative reductions, applying the function
to the previous total and the new element.  The function should take
two arguments, the previous accumulated state and the next element and
it should return a new accumulated state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>func</strong> (<em>callable</em>) – The function to map on the event data</li>
<li><strong>upstream</strong> (<em>EventStream instance</em>) – The source of the data</li>
<li><strong>state_key</strong> (<em>str</em>) – The keyword for current accumulated state in the func</li>
<li><strong>full_event</strong> (<em>bool, optional</em>) – If True expose the full event dict to the predicate, if False
only expose the data from the event</li>
<li><strong>input_info</strong> (<em>dict</em>) – describe the incoming streams
Note that only one key allowed since the func only takes two inputs</li>
<li><strong>output_info</strong> (<em>list of tuples</em>) – describe the resulting stream</li>
<li><strong>start</strong> (<em>any or callable, optional</em>) – Starting value for accumulation, if no_default use the event data
dictionary, if callable run that callable on the event data, else
use <cite>start</cite> as the starting data, defaults to no_default</li>
<li><strong>across_start</strong> (<em>bool, optional</em>) – If the accumulation should continue across multiple starts, defaults
to False</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">shed.utils</span> <span class="k">import</span> <span class="n">to_event_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">streamz_ext</span> <span class="k">import</span> <span class="n">Stream</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">shed.event_streams</span> <span class="k">as</span> <span class="nn">es</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># base data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">to_event_model</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">es</span><span class="o">.</span><span class="n">dstar</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">),</span> <span class="n">source</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">input_info</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="s1">&#39;det&#39;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="n">output_info</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;res&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;docstring&#39;</span><span class="p">,</span> <span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})],</span>
<span class="gp">... </span>    <span class="n">state_key</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink</span><span class="p">(</span><span class="nb">print</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink_to_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span> <span class="n">z</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span>
</pre></div>
</div>
<dl class="method">
<dt id="shed.event_streams.accumulate.event">
<code class="descname">event</code><span class="sig-paren">(</span><em>doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#accumulate.event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.accumulate.event" title="Permalink to this definition">¶</a></dt>
<dd><p>Issue event document for input documents</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>docs</strong> (<em>tuple of dicts or dict</em>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>name</strong> (<em>‘event’</em>)</li>
<li><strong>doc</strong> (<em>dict</em>) – The document</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="shed.event_streams.combine_latest">
<em class="property">class </em><code class="descclassname">shed.event_streams.</code><code class="descname">combine_latest</code><span class="sig-paren">(</span><em>*upstreams</em>, <em>emit_on=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#combine_latest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.combine_latest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shed.event_streams.EventStream" title="shed.event_streams.EventStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">shed.event_streams.EventStream</span></code></a></p>
<p>Combine multiple streams together to a stream of tuples</p>
<p>This will emit a new tuple of all of the most recent elements seen from
any stream.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>upstreams</strong> (<em>EventStream instances</em>) – The streams to combine</li>
<li><strong>emit_on</strong> (<em>EventStream, list of EventStreams or None</em>) – Only emit upon update of the streams listed.
If None, emit on update from any stream</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">shed.utils</span> <span class="k">import</span> <span class="n">to_event_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">streamz_ext</span> <span class="k">import</span> <span class="n">Stream</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">shed.event_streams</span> <span class="k">as</span> <span class="nn">es</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># base data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">to_event_model</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gg</span> <span class="o">=</span> <span class="n">to_event_model</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source2</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">combine_latest</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">source2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink</span><span class="p">(</span><span class="nb">print</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink_to_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">doc1</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span> <span class="n">zz</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">doc1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">doc2</span> <span class="ow">in</span> <span class="n">gg</span><span class="p">:</span> <span class="n">z</span> <span class="o">=</span> <span class="n">source2</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">doc2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="shed.event_streams.combine_latest.special_docs_names">
<code class="descname">special_docs_names</code><em class="property"> = ['start', 'descriptor', 'stop']</em><a class="headerlink" href="#shed.event_streams.combine_latest.special_docs_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="shed.event_streams.combine_latest.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>x</em>, <em>who=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#combine_latest.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.combine_latest.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Emit the new name document pair</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>tuple</em>) – Name document pair</li>
<li><strong>who</strong> (<em>stream instance, optional</em>) – This is mostly used internally for emit</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The list of issued documents, used for back pressure</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="shed.event_streams.dstar">
<code class="descclassname">shed.event_streams.</code><code class="descname">dstar</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#dstar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.dstar" title="Permalink to this definition">¶</a></dt>
<dd><p>Take dict and <a href="#id1"><span class="problematic" id="id2">**</span></a>kwargs and unpack both it as <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs</p>
</dd></dl>

<dl class="class">
<dt id="shed.event_streams.fill_events">
<em class="property">class </em><code class="descclassname">shed.event_streams.</code><code class="descname">fill_events</code><span class="sig-paren">(</span><em>db</em>, <em>upstream</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#fill_events"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.fill_events" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shed.event_streams.EventStream" title="shed.event_streams.EventStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">shed.event_streams.EventStream</span></code></a></p>
<p>Fill events without provenence</p>
<dl class="method">
<dt id="shed.event_streams.fill_events.descriptor">
<code class="descname">descriptor</code><span class="sig-paren">(</span><em>docs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#fill_events.descriptor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.fill_events.descriptor" title="Permalink to this definition">¶</a></dt>
<dd><p>Issue new descriptor document for input documents</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>docs</strong> (<em>tuple of dicts or dict</em>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>name</strong> (<em>‘descriptor’</em>)</li>
<li><strong>doc</strong> (<em>dict</em>) – The document</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="shed.event_streams.fill_events.event">
<code class="descname">event</code><span class="sig-paren">(</span><em>docs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#fill_events.event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.fill_events.event" title="Permalink to this definition">¶</a></dt>
<dd><p>Issue event document for input documents</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>docs</strong> (<em>tuple of dicts or dict</em>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>name</strong> (<em>‘event’</em>)</li>
<li><strong>doc</strong> (<em>dict</em>) – The document</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="shed.event_streams.fill_events.start">
<code class="descname">start</code><span class="sig-paren">(</span><em>docs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#fill_events.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.fill_events.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Issue new start document for input documents</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>docs</strong> (<em>tuple of dicts or dict</em>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>name</strong> (<em>‘start’</em>)</li>
<li><strong>doc</strong> (<em>dict</em>) – The document</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="shed.event_streams.fill_events.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><em>docs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#fill_events.stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.fill_events.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Issue new stop document</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>docs</strong> (<em>tuple of dicts or dict or Exception</em>) – If Exception issue a stop which notes the failure</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>name</strong> (<em>‘stop’</em>)</li>
<li><strong>doc</strong> (<em>dict</em>) – The document</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="shed.event_streams.filter">
<em class="property">class </em><code class="descclassname">shed.event_streams.</code><code class="descname">filter</code><span class="sig-paren">(</span><em>predicate</em>, <em>upstream</em>, <em>*args</em>, <em>input_info=None</em>, <em>full_event=False</em>, <em>document_name='event'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shed.event_streams.EventStream" title="shed.event_streams.EventStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">shed.event_streams.EventStream</span></code></a></p>
<p>Only pass through events that satisfy the predicate</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>predicate</strong> (<em>callable</em>) – The function which returns True if the event is to propagate
further in the pipeline</li>
<li><strong>upstream</strong> (<em>EventStream instance</em>) – The source of the data</li>
<li><strong>*args</strong> (<em>tuple</em>) – args to be passed to the function,
which are appended to the args from <cite>input_info</cite></li>
<li><strong>input_info</strong> (<em>dict</em>) – describe the incoming streams</li>
<li><strong>full_event</strong> (<em>bool, optional</em>) – If True expose the full event dict to the predicate, if False
only expose the data from the event</li>
<li><strong>document_name</strong> (<em>{‘event’, ‘start’, ‘descriptor’}, optional</em>) – Which document to filter on, if event only pass events which meet the
criteria. Otherwise if <code class="docutils literal notranslate"><span class="pre">start</span></code> only pass streams where the criteria
is True in the start. Otherwise if <code class="docutils literal notranslate"><span class="pre">descriptor</span></code> only pass streams
where the criteria is True in the descriptor. Defaults to ‘event’.</li>
<li><strong>**kwargs</strong> (<em>dict</em>) – kwargs to be passed to the function</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">shed.utils</span> <span class="k">import</span> <span class="n">to_event_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">streamz_ext</span> <span class="k">import</span> <span class="n">Stream</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">shed.event_streams</span> <span class="k">as</span> <span class="nn">es</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># base data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">to_event_model</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">input_info</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;det&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink</span><span class="p">(</span><span class="nb">print</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink_to_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span> <span class="n">z</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span>
</pre></div>
</div>
<p>Filtering full headers</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">shed.utils</span> <span class="k">import</span> <span class="n">to_event_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">streamz_ext</span> <span class="k">import</span> <span class="n">Stream</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">shed.event_streams</span> <span class="k">as</span> <span class="nn">es</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># base data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">to_event_model</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;source&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;to_event_model&#39;</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">document_name</span><span class="o">=</span><span class="s1">&#39;start&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink</span><span class="p">(</span><span class="nb">print</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink_to_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span> <span class="n">z</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Filtering on descriptors</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">shed.utils</span> <span class="k">import</span> <span class="n">to_event_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">streamz_ext</span> <span class="k">import</span> <span class="n">Stream</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">shed.event_streams</span> <span class="k">as</span> <span class="nn">es</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># base data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">to_event_model</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;primary&#39;</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">document_name</span><span class="o">=</span><span class="s1">&#39;descriptor&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink</span><span class="p">(</span><span class="nb">print</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink_to_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span> <span class="n">z</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
</pre></div>
</div>
<dl class="method">
<dt id="shed.event_streams.filter.event">
<code class="descname">event</code><span class="sig-paren">(</span><em>doc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#filter.event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.filter.event" title="Permalink to this definition">¶</a></dt>
<dd><p>Issue event document for input documents</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>docs</strong> (<em>tuple of dicts or dict</em>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>name</strong> (<em>‘event’</em>)</li>
<li><strong>doc</strong> (<em>dict</em>) – The document</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="shed.event_streams.istar">
<code class="descclassname">shed.event_streams.</code><code class="descname">istar</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#istar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.istar" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse of star, take <a href="#id5"><span class="problematic" id="id6">*</span></a>args and turn into tuple</p>
</dd></dl>

<dl class="class">
<dt id="shed.event_streams.map">
<em class="property">class </em><code class="descclassname">shed.event_streams.</code><code class="descname">map</code><span class="sig-paren">(</span><em>func</em>, <em>upstream</em>, <em>*args</em>, <em>full_event=False</em>, <em>output_info=None</em>, <em>input_info=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.map" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shed.event_streams.EventStream" title="shed.event_streams.EventStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">shed.event_streams.EventStream</span></code></a></p>
<p>Apply a function onto every event in the stream</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>func</strong> (<em>callable</em>) – The function to map on the event data</li>
<li><strong>upstream</strong> (<em>EventStream instance</em>) – The source of the data</li>
<li><strong>*args</strong> (<em>tuple</em>) – args to be passed to the function,
which are appended to the args from <cite>input_info</cite></li>
<li><strong>full_event</strong> (<em>bool, optional</em>) – If True expose the full event dict to the function, if False
only expose the data from the event</li>
<li><strong>input_info</strong> (<em>dict</em>) – describe the incoming streams</li>
<li><strong>output_info</strong> (<em>list of tuples</em>) – describe the resulting stream</li>
<li><strong>**kwargs</strong> (<em>dict</em>) – kwargs to be passed to the function</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">shed.utils</span> <span class="k">import</span> <span class="n">to_event_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">streamz_ext</span> <span class="k">import</span> <span class="n">Stream</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">shed.event_streams</span> <span class="k">as</span> <span class="nn">es</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># base data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">to_event_model</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">es</span><span class="o">.</span><span class="n">dstar</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="mi">5</span><span class="p">),</span> <span class="n">source</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">input_info</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;det&#39;</span><span class="p">},</span>
<span class="gp">... </span>    <span class="n">output_info</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;res&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;docstring&#39;</span><span class="p">,</span> <span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink</span><span class="p">(</span><span class="nb">print</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink_to_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span> <span class="n">z</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span>
</pre></div>
</div>
<dl class="method">
<dt id="shed.event_streams.map.event">
<code class="descname">event</code><span class="sig-paren">(</span><em>docs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#map.event"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.map.event" title="Permalink to this definition">¶</a></dt>
<dd><p>Issue event document for input documents</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>docs</strong> (<em>tuple of dicts or dict</em>)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>name</strong> (<em>‘event’</em>)</li>
<li><strong>doc</strong> (<em>dict</em>) – The document</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="shed.event_streams.split">
<em class="property">class </em><code class="descclassname">shed.event_streams.</code><code class="descname">split</code><span class="sig-paren">(</span><em>upstream</em>, <em>n_streams</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shed.event_streams.EventStream" title="shed.event_streams.EventStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">shed.event_streams.EventStream</span></code></a></p>
<dl class="method">
<dt id="shed.event_streams.split.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>x</em>, <em>who=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#split.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.split.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Emit the new name document pair</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>tuple</em>) – Name document pair</li>
<li><strong>who</strong> (<em>stream instance, optional</em>) – This is mostly used internally for emit</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The list of issued documents, used for back pressure</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="shed.event_streams.star">
<code class="descclassname">shed.event_streams.</code><code class="descname">star</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#star"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.star" title="Permalink to this definition">¶</a></dt>
<dd><p>Take tuple and unpack it into args</p>
</dd></dl>

<dl class="class">
<dt id="shed.event_streams.zip">
<em class="property">class </em><code class="descclassname">shed.event_streams.</code><code class="descname">zip</code><span class="sig-paren">(</span><em>*upstreams</em>, <em>zip_type='extend'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#zip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.zip" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shed.event_streams.EventStream" title="shed.event_streams.EventStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">shed.event_streams.EventStream</span></code></a></p>
<p>Combine multiple streams together into a stream of tuples</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>upstreams</strong> (<em>EventStream instances</em>) – The event streams to be zipped together</li>
<li><strong>zip_type</strong> (<em>{‘extend’, ‘strict’, ‘truncate}, optional</em>) – What type of zip to perform. If strict then the streams are assumed
to be equal length, and raises an error otherwise. If extend then
streams in the secondary positions (not the first arg) will be extended
to match the length of the first stream with the latest event repeated
as needed. If truncate documents will be emitted to match the length
of the first stream by shortenin the secondary streams.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">shed.utils</span> <span class="k">import</span> <span class="n">to_event_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">streamz_ext</span> <span class="k">import</span> <span class="n">Stream</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">shed.event_streams</span> <span class="k">as</span> <span class="nn">es</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">builtins</span> <span class="k">import</span> <span class="nb">zip</span> <span class="k">as</span> <span class="n">zzip</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># base data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">to_event_model</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gg</span> <span class="o">=</span> <span class="n">to_event_model</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source2</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">zip</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">source2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink</span><span class="p">(</span><span class="nb">print</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink_to_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">doc1</span><span class="p">,</span> <span class="n">doc2</span> <span class="ow">in</span> <span class="n">zzip</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">gg</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">z</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">doc1</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">zz</span> <span class="o">=</span> <span class="n">source2</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">doc2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="shed.event_streams.zip_latest">
<em class="property">class </em><code class="descclassname">shed.event_streams.</code><code class="descname">zip_latest</code><span class="sig-paren">(</span><em>lossless</em>, <em>*upstreams</em>, <em>clear_on_lossless_stop=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#zip_latest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.zip_latest" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#shed.event_streams.EventStream" title="shed.event_streams.EventStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">shed.event_streams.EventStream</span></code></a></p>
<p>Combine multiple streams together to a stream of tuples</p>
<p>This will emit a new tuple of the elements from the lossless stream paired
with the latest elements from the other streams.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lossless</strong> (<em>EventStream instance</em>) – The stream who’s documents will always be emitted</li>
<li><strong>upstreams</strong> (<em>EventStream instances</em>) – The streams to combine</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">shed.utils</span> <span class="k">import</span> <span class="n">to_event_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">streamz_ext</span> <span class="k">import</span> <span class="n">Stream</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">shed.event_streams</span> <span class="k">as</span> <span class="nn">es</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>  <span class="c1"># base data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">to_event_model</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gg</span> <span class="o">=</span> <span class="n">to_event_model</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;det&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">})])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source2</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">es</span><span class="o">.</span><span class="n">zip_latest</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">source2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink</span><span class="p">(</span><span class="nb">print</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">sink_to_list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">doc1</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span> <span class="n">zz</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">doc1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">doc2</span> <span class="ow">in</span> <span class="n">gg</span><span class="p">:</span> <span class="n">z</span> <span class="o">=</span> <span class="n">source2</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">doc2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="shed.event_streams.zip_latest.special_docs_names">
<code class="descname">special_docs_names</code><em class="property"> = ['start', 'descriptor', 'stop']</em><a class="headerlink" href="#shed.event_streams.zip_latest.special_docs_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="shed.event_streams.zip_latest.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>x</em>, <em>who=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/shed/event_streams.html#zip_latest.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#shed.event_streams.zip_latest.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Emit the new name document pair</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>tuple</em>) – Name document pair</li>
<li><strong>who</strong> (<em>stream instance, optional</em>) – This is mostly used internally for emit</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The list of issued documents, used for back pressure</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-shed.unused_streams">
<span id="shed-unused-streams-module"></span><h2>shed.unused_streams module<a class="headerlink" href="#module-shed.unused_streams" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-shed">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-shed" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="shed.tests.html" class="btn btn-neutral float-right" title="shed.tests package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to SHED’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Author.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>